"use strict";(self.webpackChunkmy_app=self.webpackChunkmy_app||[]).push([[206],{206:function(e,s,t){t.r(s),t.d(s,{default:function(){return B}});var n=t(885),a=t(2791),r=t(4735),i=t(7137),o=t(4165),l=t(5861),c=t(6382),u=t(2207),m=(0,c.hg)("dialogs/getFriendsForDialogs",function(){var e=(0,l.Z)((0,o.Z)().mark((function e(s,t){var n,a;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.dispatch,e.prev=1,e.next=4,u.T.getUser(1,10,"",!0);case 4:a=e.sent,n((0,i.wE)(a.items)),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.warn(e.t0);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(s,t){return e.apply(this,arguments)}}()),d=function(e){return e.dialogsPage.dialogsData},_=function(e){return e.dialogsPage.messagesData},g=t(2312),f=t(7458),v=t(6731),h=t(6029),x=t(184),p=(0,a.memo)((function(e){var s=e.state,t=s.name,n=s.photos;return(0,x.jsx)("li",{className:"dialogs-list__item__container",children:(0,x.jsxs)("div",{className:"dialogs-list__item__box-for-dot",children:[(0,x.jsx)("div",{className:"dialogs-list__item__dot"}),(0,x.jsxs)(v.OL,{to:"/Dialogs",className:"dialogs-list__item__inner",children:[(0,x.jsx)("img",{src:n.small?n.small:h,className:"dialogs-list__item__avatar",alt:"avatar"}),(0,x.jsx)("p",{className:"dialogs-list__item__name",children:t})]})]})})})),j=t(7818),N=(0,a.memo)((function(e){var s=e.state,t=s.message,n=s.avatar;return(0,x.jsx)("div",{className:"dialogs-invert-message__item__lean-to-the-left-board-box",children:(0,x.jsxs)("div",{className:"dialogs-invert-message__item__container",children:[(0,x.jsx)("div",{className:"dialogs-invert-message__item__text__inner",children:(0,x.jsx)("p",{className:"dialogs-invert-message__item__text",children:t})}),(0,x.jsx)(j.Z,{avatar:n})]})})})),w=(0,a.memo)((function(e){var s=e.state,t=s.message,n=s.avatar;return(0,x.jsxs)("div",{className:"dialogs-message__item__conatiner",children:[(0,x.jsx)(j.Z,{avatar:n}),(0,x.jsx)("div",{className:"dialogs-message__item__text__inner",children:(0,x.jsx)("p",{className:"dialogs-message__item__text",children:t})})]})})),b=t(5033),Z=(0,a.memo)((function(e){var s=e.dialog,t=e.setShowBtn,r=e.isActive,i=(0,a.useState)(!0),o=(0,n.Z)(i,2),l=o[0],c=o[1],u=(0,a.useState)(),m=(0,n.Z)(u,2),d=m[0],_=m[1];(0,a.useEffect)((function(){r===s?(c(!0),t(null),clearTimeout(d)):(c(!0),clearTimeout(d))}),[r,s]);return(0,x.jsx)("div",{onClick:function(){t(s),c(!1);var e=setTimeout((function(){c(!0),t(null)}),5e3);_(e)},children:l&&(0,x.jsx)(b.Z,{className:"dialogs-list__edit-toggler _visible"})})})),k=(0,a.memo)((function(){var e=(0,r.C)(d),s=(0,a.useState)(null),t=(0,n.Z)(s,2),i=t[0],o=t[1],l=(0,a.useState)(null),c=(0,n.Z)(l,2),u=c[0],_=c[1],g=(0,r.T)(),v=e.map((function(s){return(0,x.jsxs)("div",{onClick:function(){o(s)},style:{height:"70px"},className:"".concat(null===i?s===e[0]&&" _active":i===s&&" _active"),children:[!!s.followed&&(0,x.jsx)(p,{state:s}),u===s&&(0,x.jsxs)("button",{onClick:function(){var e=s.id;g((0,f.kW)(e));setTimeout((function(){return g(m())}),500),_(null)},className:"dialogs-list__delete-dialog-btn btn _hover _visible",children:[(0,x.jsx)("div",{className:"dialogs-list__delete-dialog-btn__dot"}),(0,x.jsx)("span",{children:"delete dialog"})]}),(0,x.jsx)(Z,{isActive:i,dialog:s,setShowBtn:_})]},s.id)}));return(0,x.jsx)(x.Fragment,{children:v})})),T=function(){var e=(0,r.C)(_).map((function(e){for(var s=["2","5","7","3"],t=0;t<s.length;t++)if(s[t]===e.id)return(0,x.jsx)(N,{state:e},e.id);return(0,x.jsx)(w,{state:e},e.id)}));return(0,x.jsx)(x.Fragment,{children:e})},S=t(1271),y=t(2038),C=t(2506),F=(0,a.memo)((function(e){var s=e.sendNewMessageBody,t=(0,r.C)(y.y5);return(0,x.jsx)(C.J9,{initialValues:{message_form__text:""},validate:S.wg,onSubmit:function(e,n){var a=n.setSubmitting,r=n.resetForm;e.message_form__text&&setTimeout((function(){var n=e.message_form__text,i=t.small;s({message:n,avatar:i}),r({}),a(!1)}),400)},children:function(e){var s=e.isSubmitting,t=(e.resetForm,e.handleChange);return(0,x.jsxs)(C.l0,{className:"dialogs-message-form__inner",children:[(0,x.jsx)(C.gN,{type:"text",name:"message_form__text",placeholder:"Enter your message...",onChange:t,className:"dialogs-message-form__textarea"}),(0,x.jsx)(C.Bc,{name:"message_form__text",component:"div",className:"_error"}),(0,x.jsx)("button",{type:"submit",disabled:s,className:"dialogs-message-form__btn btn _hover",children:"Send"})]})}})})),D=F,M=(0,a.memo)((function(){var e=(0,r.C)(_),s=(0,a.useRef)(null),t=(0,a.useState)(!0),o=(0,n.Z)(t,2),l=o[0],c=o[1],u=(0,r.T)();(0,a.useEffect)((function(){if(l){setTimeout((function(){var e;return null===(e=s.current)||void 0===e?void 0:e.scrollIntoView({block:"end",behavior:"smooth"})}),300)}}),[e,l]),(0,a.useEffect)((function(){u(m())}),[u]);return(0,x.jsxs)("main",{className:"dialogs__container",children:[(0,x.jsx)("h2",{className:"main-page__h2",children:"DIALOGS"}),(0,x.jsxs)("div",{className:"dialogs__wrapper",children:[(0,x.jsx)("section",{className:"dialogs-list__container",children:(0,x.jsx)("div",{className:"dialogs-list__inner",children:(0,x.jsx)("ul",{children:(0,x.jsx)(k,{})})})}),(0,x.jsxs)("section",{className:"dialogs-messages__container",children:[(0,x.jsxs)("div",{onScroll:function(e){var s=e.currentTarget;Math.abs(s.scrollHeight-s.scrollTop-s.clientHeight)<300?!l&&c(!0):l&&c(!1)},className:"dialogs-messages__chat-container",children:[(0,x.jsx)(T,{}),(0,x.jsx)("div",{ref:s})]}),(0,x.jsx)(D,{sendNewMessageBody:function(e){var s=e.message,t=e.avatar;u((0,i.ww)({message:s,avatar:t}))}})]})]})]})})),B=(0,g.h)(M)},7458:function(e,s,t){t.d(s,{D7:function(){return c},gO:function(){return m},kW:function(){return d}});var n=t(4165),a=t(5861),r=t(6382),i=t(7047),o=t(343),l=t(2207),c=(0,r.hg)("users/requestUsers",function(){var e=(0,a.Z)((0,n.Z)().mark((function e(s,t){var a,r,o,c,u;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=s.actualPage,r=s.pageSize,o=s.actualFilter,c=t.dispatch,e.prev=2,c((0,i.MO)(!0)),c((0,i.D4)(a)),c((0,i.Tv)(o)),e.next=8,l.T.getUser(a,r,o.term,o.friend);case 8:u=e.sent,c((0,i.MO)(!1)),c((0,i.HM)(u.items)),c((0,i.K1)(u.totalCount)),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(2),console.warn(e.t0);case 17:case"end":return e.stop()}}),e,null,[[2,14]])})));return function(s,t){return e.apply(this,arguments)}}()),u=function(){var e=(0,a.Z)((0,n.Z)().mark((function e(s,t,a,r){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,s((0,i.ZH)({inProgress:!0,userId:t})),e.next=4,a(t);case 4:e.sent.resultCode===o.Rs.Success&&s(r(t)),s((0,i.ZH)({inProgress:!1,userId:t})),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.warn(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(s,t,n,a){return e.apply(this,arguments)}}(),m=(0,r.hg)("users/getFollow",function(){var e=(0,a.Z)((0,n.Z)().mark((function e(s,t){var a;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.dispatch,e.next=3,u(a,s,l.T.follow.bind(l.T),i.ZN);case 3:case"end":return e.stop()}}),e)})));return function(s,t){return e.apply(this,arguments)}}()),d=(0,r.hg)("users/getUnfollow",function(){var e=(0,a.Z)((0,n.Z)().mark((function e(s,t){var a;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.dispatch,e.next=3,u(a,s,l.T.unfollow.bind(l.T),i.fv);case 3:case"end":return e.stop()}}),e)})));return function(s,t){return e.apply(this,arguments)}}())}}]);
//# sourceMappingURL=206.4b12db83.chunk.js.map